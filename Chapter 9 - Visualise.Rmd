---
title: "R Notebook"
output: html_notebook
---


# 0.0 Imports



```{r}
renv::restore()
```


```{r}
library(tidyverse)
```

```{r}
ggplot(diamonds, aes(x = carat)) +
  geom_histogram(binwidth = 0.5)
```


```{r}
smaller <- diamonds |> filter(carat <3)
ggplot(smaller, aes(x = carat)) +
  geom_histogram( binwidth = 0.01)
```

```{r}
ggplot(diamonds, aes(x = y)) +
  geom_histogram(binwidth = 0.5)
```


```{r}
ggplot(diamonds, aes(x = y)) +
  geom_histogram(binwidth = 0.5) +
  coord_cartesian(ylim = c(0, 50))
```

```{r}
unusual <- diamonds |> 
  filter(y < 3 | y > 20) |> 
  select(price, x, y, z) |> 
  arrange(y)
unusual
```



# 1.0 Variation:


```{r}
#1.0
ggplot(diamonds, aes(x = x)) +
  geom_histogram()

ggplot(diamonds, aes(x = y)) +
  geom_histogram()

ggplot(diamonds, aes(x = z)) +
  geom_histogram()


#2.0
ggplot(diamonds, aes(x = price)) +
  geom_histogram(binwidth = 15)

#3.0
diamonds |> count(carat)

#0.99 carat 23
#1 carat 1558
#maybe was a problem in data collectiony

#4.0
ggplot(diamonds, aes(x = price)) +
  geom_histogram(binwidth = 100) +
  coord_cartesian(xlim = c(0,2000))

#The binwidth gets very big when you zoom and in and don't set its value.
```

# 2.0 Unusual Values


```{r}
#Replace null values with NA

diamonds2 <- diamonds |> 
  mutate(y = if_else(y < 3 | y > 20, NA, y))

ggplot(diamonds2, aes(x = x, y = y)) +
  geom_point()

```

```{r}
```


```{r}
nycflights13::flights |> 
  mutate(
    cancelled = is.na(dep_time),
    sched_hour = sched_dep_time %/% 100,
    sched_min = sched_dep_time %% 100,
    sched_dep_time = sched_hour + (sched_min/60),
  ) |> 
  ggplot(aes(x = sched_dep_time)) +
  geom_freqpoly(aes(color = cancelled), binwidth = 1/4)
```

```{r}
#1)
ggplot(diamonds2, aes(x = x, y = y)) +
  geom_point()
ggplot(diamonds2, aes(x = y)) +
  geom_bar()
#both histogram and barchart omits missing values

#2)
mean(diamonds$y)

mean(diamonds$y, na.rm = TRUE)
#na.rm remove the NAs before the computation

#3)
nycflights13::flights |> 
  mutate(
    cancelled = is.na(dep_time),
    sched_hour = sched_dep_time %/% 100,
    sched_min = sched_dep_time %% 100,
    sched_dep_time = sched_hour + (sched_min/60),
  ) |> 
  ggplot(aes(x = sched_dep_time)) +
  geom_freqpoly(aes(color = cancelled)
                , binwidth = 1/4
                ) +
  facet_grid(rows = vars(cancelled)
             ,scales = "free_y"
             ,shrink = TRUE
             )
```

# 3.0 Covariation


```{r}
ggplot(diamonds, aes(x = price)) +
  geom_freqpoly(aes(color = cut), binwidth = 500, linewidth = 0.75)
```

```{r}
ggplot(diamonds, aes(x = price, y = after_stat(density))) +
  geom_freqpoly(aes(color = cut), binwidth = 500, linewidth = 0.75)
```

```{r}
ggplot(diamonds, aes(x = cut, y = price)) + geom_boxplot()
```

```{r}
ggplot(mpg, aes(x = class, y = hwy)) + geom_boxplot()
```

```{r}
ggplot(mpg, aes(x = fct_reorder(class, hwy, median) , y = hwy)) + geom_boxplot()
```
```{r}
ggplot(mpg, aes(x = hwy, y = fct_reorder(class, hwy, median))) + geom_boxplot()
```

```{r}
flight <- as_tibble(nycflights13::flights) |>
  mutate( cancelled = is.na(dep_time) )
head(flight)
```

## 3.1 Exercises

```{r}
ggplot(flight, aes(x = cancelled, y = dep_time)) +
  geom_boxplot()
```

```{r}

for (i in diamonds |> select(!where(is.numeric)) |> colnames()) {
  print(i)
}
```



```{r}

for (i in diamonds |> select(!where(is.numeric)) |> colnames()) {
  p <- ggplot(diamonds, aes(x = fct_reorder(diamonds[[i]], y, median), y = price)) +
    geom_boxplot() +
    #labs(x = i, y = "price",
    #     title = glue::glue("PreÃ§o vs {i}"),
    #     subtitle = "taptap") +
    ggeasy::easy_center_title()
  print(p)
}
```

```{r}
for (i in diamonds |> select(!where(is.numeric)) |> colnames()) {
  p <- ggplot(diamonds, aes(x = diamonds[[i]], y=price)) +
    lvplot::geom_lv() + 
    labs(x = i)
  print(p)
}
```

```{r}
ggplot(diamonds, aes( x=cut, y=price )) +
  geom_violin()
ggplot(diamonds, aes( x=price )) +
  geom_histogram() +
  facet_grid( rows=cut )
ggplot(diamonds, aes( x=cut, y=price )) +
  geom_freqpoly()
ggplot(diamonds, aes( x=cut, y=price )) +
  geom_density()
```


