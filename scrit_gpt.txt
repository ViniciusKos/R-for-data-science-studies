import pandas as pd
import re

# Sample DataFrame creation
# Replace this with your actual DataFrame
data = {
    'column_name': [
        'pix 12345678901234 recebido',
        'pix 1234567890123 recebido',
        '12345678901234 pix recebido',
        'pixrecebido 12345678901234',
        'some unrelated text'
    ]
}
df = pd.DataFrame(data)

# Regular expression pattern for filtering
filter_pattern = r'(?=.*pix)(?=.*recebido).*\b\d{14}\b.*'
# Regular expression pattern for extracting 14-digit number
extract_pattern = r'\b(\d{14})\b'

# Filter the DataFrame
filtered_df = df[df['column_name'].str.contains(filter_pattern, flags=re.IGNORECASE)]

# Extract the 14-digit sequence into a new column
filtered_df['extracted_sequence'] = filtered_df['column_name'].str.extract(extract_pattern)

print(filtered_df)
